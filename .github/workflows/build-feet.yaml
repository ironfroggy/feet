name: Feet Build

on:
  # allow running manually
  workflow_dispatch:
  pull_request:
    branches: [ '*' ]
  push:
    branches: [ 'main', 'stable-*' ]

jobs:
  feet-build:
    runs-on: ubuntu-latest
    env:
      # base of a PR, or pushed-to branch outside PRs, or master
      BRANCH: ${{ github.base_ref || github.ref || 'refs/heads/main' }}

    steps:

    - uses: actions/checkout@v2
      with:
        path: 'feet'
    - name: "Install rust"
      working-directory: "feet"
      run: |
        curl https://sh.rustup.rs -sSf | sh -s -- -y
    - name: "Install Python requirements"
      working-directory: "feet"
      run: |
        cd /home/runner/work/feet/feet
        pip install -r requirements.txt
    - name: "Build Feet"
      working-directory: "feet"
      run: |
        python build.py build
